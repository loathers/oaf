generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Greenbox {
  id        Int      @id @default(autoincrement())
  playerId  Int
  player    Player   @relation(fields: [playerId], references: [playerId])
  data      String
  createdAt DateTime @default(now())
}

model Player {
  playerId            Int             @id
  playerName          String
  accountCreationDate DateTime?
  kills               Int             @default(0)
  skills              Int             @default(0)
  doneWithSkills      Boolean         @default(false)
  brainiac            Boolean         @default(false)
  discordId           String?
  greenbox            Greenbox[]
  greenboxString      String?
  greenboxLastUpdate  DateTime?
  thiccEntered        Boolean         @default(false)
  thiccGifteeId       Int?            @unique
  thiccGiftee         Player?         @relation("ThiccGiftee", fields: [thiccGifteeId], references: [playerId])
  thiccGifter         Player?         @relation("ThiccGiftee")
  standinfOffers      StandingOffer[]
}

model StandingOffer {
  itemId   Int
  price    Int
  buyerId  Int
  offeredAt DateTime @default(now())
  buyer    Player @relation(fields: [buyerId], references: [playerId])


  @@unique([buyerId, itemId])
}

model Reminder {
  id                 Int      @id @default(autoincrement())
  guildId            String?
  channelId          String
  userId             String
  messageContents    String
  reminderDate       DateTime
  interactionReplyId String?
  reminderSent       Boolean  @default(false)
}

model Raid {
  id Int @id
}

model Tag {
  tag       String   @id
  reason    String?
  channelId String
  guildId   String
  messageId String
  createdAt DateTime @default(now())
  createdBy String

  // A message can only have one tag
  @@unique([guildId, channelId, messageId])
}

model Setting {
  key   String @id
  value Json
}
